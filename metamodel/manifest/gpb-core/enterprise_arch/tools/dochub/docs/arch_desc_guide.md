# Руководство по описанию прикладной архитектуры ГПБ

## Введение

Данное руководство касается только описания архитектуры уровней ПА-L1 (общая прикладная архитектура) и ПА-L2 (прикладная архитектура проектов).


## Правила описания прикладной архитектуры компании в DocHub

В данном разделе описаны основные правила описания прикладной архитектуры в DocHub. При этом нужно учитывать, что инструмент DocHub постоянно развивается и часть информации может быть неактуальной. С целью минимизации таких ситуаций описание происходит на достаточно высоком уровне. 


Есть [сайт разработчика DocHub](https://dochub.info) где можно посмотреть примеры использования инструмента и подробно ознакомиться с его возможностями.

### Правила описания прикладной архитектуры компании уровня ПА-L1

#### Структура данных для управления системами

Описание репозитория можно найти [здесь](/docs/dochub_app_repo_guide).


#### Правила именования объектов связанных с системами

1. Все имена, названия и код должны писаться в нотации [snake_case](https://ru.wikipedia.org/wiki/Snake_case)
2. Имя yaml файла описывающего конкретную систему должно соответствовать имени системы внутри идентификатора системы (см. п.3)
3. Идентификатор системы в общем случае представляет из себя доменное имя в виде:
`gpb.<название подразделения/стрима>.<название системы>`



### Правила описания прикладной архитектуры компании уровня ПА-L2

Для описания компонент АС системы есть 2 пути:
1. Описать компоненты системы внутри общего репозитория GPB
2. Описать компоненты системы внутри собственного репозитория системы

С точки зрения конечных данных оба варианта равнозначны и выбор только за вами.

**Советы по выбору варианта**
1. Если вы один архитектор управляющий несколькими системами, то удобней управлять архитектурой своих приложений в общем репозитории GPB.
2. Если у вас одна система, которая "живет" в своем репозитории, то возможно вам будет удобнее управлять архитектурой из репозитория системы.
3. Если у вас внешняя система для которой нужно описать компоненты, то описывать их нужно в общем репозитории GPB


### Правила отображения связей между системами

#### Как понять в какую сторону отобразить стрелку при указании связи систем

В зависимости от уровня абстракции ситуация может выглядеть по-разному. Например, спускаясь на технический уровень практически в 100% случаев нам придется отобразить двухстороннюю связь между системами.

В первую очередь, это связанно с тем, что при технической реализации системе-приёмнику необходимо выполнить какое-либо действие или набор действий для того, чтобы получить данные. Поэтому использовать этот уровень абстракции на логическом уровне ПА-L1 не имеет физического смысла.

Для того чтобы корректно отобразить стрелку при указании связи систем мы рекомендуем задать вопрос: "В какую систему приходят конечные бизнес-данные, от которых зависит бизнес-процесс?".

Ответ на этот вопрос, в большинстве случаев даст вам однозначное понимание какая система отправляет данные, а какая получает их. Например, в примере описанном в разделе [&#34;Как правильно отобразить стрелки, если системы отправляют данные друг другу?&#34;](#как-правильно-отобразить-стрелки-если-системы-отправляют-данные-друг-другу) описана ситуация, когда есть два набора бизнес-данных которые отправляются из gpb.dep.system_a в gpb.dep.system_b и наоборот.

#### Как правильно отобразить стрелки, если системы отправляют данные друг другу?

В связи с тем, что описывать системы и их взаимосвязи могут разные сотрудники, то при отображении связей между системами можно задублировать их связи. Для решения этой проблемы необходимо пользоваться следующим правилом:

- В карточке системы должен отображаться только входящий поток данных: `direction: <--`.

Например, у вас есть две системы gpb.dep.system_a и gpb.dep.system_b. Обе эти системы получают данные и отправляют их друг другу.
Согласно вышеописанному правилу при описании системы gpb.dep.system_a вы должны отобразить только факт получения данных из gpb.dep.system_b.

```yaml
components:
    gpb.dep.system_a:
        title: Система А
    links:
        - id: gpb.dep.system_b
          direction: <-- # Входящий поток данных в gpb.dep.system_a из gpb.dep.system_b
```

То же самое вы должны сделать при описании системы gpb.dep.system_b

```yaml
components:
    gpb.dep.system_b:
        title: Система Б
    links:
        - id: gpb.dep.system_a
          direction: <-- # Входящий поток данных в gpb.dep.system_b из gpb.dep.system_a
```
